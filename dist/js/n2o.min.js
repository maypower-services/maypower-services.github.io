function utf8_dec(t){return(new TextDecoder).decode(t)}function utf8_enc(t){return new TextEncoder("utf-8").encode(t)}function utf8_arr(t){return t instanceof ArrayBuffer||(t=new Uint8Array(utf8_enc(t)).buffer),utf8_dec(t)}function tuple(){return{t:104,v:Array.apply(null,arguments)}}function list(){return{t:108,v:Array.apply(null,arguments)}}function map(){return{t:116,v:Array.apply(null,arguments)}}function atom(t){return{t:100,v:utf8_enc(t)}}function string(t){return{t:107,v:utf8_enc(t)}}function float(t){return{t:70,v:t}}function number(t){var n=t%1==0;return n&&t>=0&&t<256?{t:97,v:t}:n&&t>=-134217728&&t<=134217727?{t:98,v:t}:{t:110,v:t}}function bin(t){return{t:109,v:t instanceof ArrayBuffer?new Uint8Array(t):t instanceof Uint8Array?t:utf8_enc(t)}}function enc(t){return fl([131,ein(t)])}function ein(o){return Array.isArray(o)?en_108({t:108,v:o}):eval("en_"+o.t)(o)}function en_undefined(t){return[106]}function en_70(t){var n=Array(8).fill(0).flat();return write_Float(n,t.v,0,!1,52,8),[70].concat(n)}function en_97(t){return[97,t.v]}function en_98(t){return[98,t.v>>>24,t.v>>>16&255,t.v>>>8&255,255&t.v]}function en_99(t){var n=t.v.toExponential(20),e=/([^e]+)(e[+-])(\d+)/.exec(n),r=1==e[3].length?"0"+e[3]:e[3],o=Array.from(bin(e[1]+e[2]+r).v);return[t.t].concat(o).concat(Array(31-o.length).fill(0).flat())}function en_106(t){return[106]}function en_115(t){return[115,t.v.length,ar(t)]}function en_119(t){return[119,ar(t).length,ar(t)]}function en_118(t){return[118,ar(t).length>>>8,255&ar(t).length,ar(t)]}function en_100(t){return[100,t.v.length>>>8,255&t.v.length,ar(t)]}function en_107(t){return[107,t.v.length>>>8,255&t.v.length,ar(t)]}function en_104(t){for(var n=t.v.length,e=[],r=0;r<n;r++)e[r]=ein(t.v[r]);return[104,n,e]}function unilen(t){return t.v instanceof ArrayBuffer||t.v instanceof Uint8Array?t.v.byteLength:(new TextEncoder).encode(t.v).byteLength}function en_109(t){var n=unilen(t);return[109,n>>>24,n>>>16&255,n>>>8&255,255&n,ar(t)]}function en_108(t){for(var n=t.v.length,e=[],r=0;r<n;r++)e.push(ein(t.v[r]));return 0==t.v.length?[106]:[108,n>>>24,n>>>16&255,n>>>8&255,255&n,e,106]}function en_116(t){for(var n,e=t.v.length,r=[],o=0;o<e;o++)r.push([ein(t.v[o].k),ein(t.v[o].v)]);return n=[116,e>>>24,e>>>16&255,e>>>8&255,255&e],0==t.v.length?n:[n,r]}function en_110(t){var n=int_to_bytes(t.v);return[110,n.length,t.v<0?1:0].concat(n)}function nop(t){return[]}function big(t){for(var n=1==t?sx.getUint8(ix++):sx.getInt32((a=ix,ix+=4,a)),e=0,r=sx.getUint8(ix++),o=n;o-- >0;)e=256*e+sx.getUint8(ix+o);return ix+=n,e*(0==r?1:-1)}function int(t){return 1==t?sx.getUint8(ix++):sx.getInt32((a=ix,ix+=4,a))}function dec(t){if(sx=new DataView(t),ix=0,131!==sx.getUint8(ix++))throw"BERT?";return din()}function str(t){var n=2==t?sx.getUint16(ix):1==t?sx.getUint8(ix):sx.getUint32(ix);return ix+=t,utf8_arr(sx.buffer.slice(ix,ix+=n))}function run(t){var n=1==t?sx.getUint8(ix):sx.getUint32(ix),e=[];ix+=t;for(var r=0;r<n;r++)e.push(din());return e}function rut(t){var n=1==t?sx.getUint8(ix):sx.getUint32(ix),e=[];ix+=t;for(var r=0;r<n;r++)e.push(din());return din(),e}function dic(t){var n=sx.getUint32(ix),e=[];ix+=4;for(var r=0;r<n;r++)e.push({k:din(),v:din()});return e}function iee(t){return read_Float(new Uint8Array(sx.buffer.slice(ix,ix+=8)),0,!1,52,8)}function flo(t){return parseFloat(utf8_arr(sx.buffer.slice(ix,ix+=31)))}function arr(t){var n=sx.getUint16(ix);return ix+=t,new Uint8Array(sx.buffer.slice(ix,ix+=n))}function ref(t){var n,e=sx.getUint8(ix++);return e+=sx.getUint8(ix++),n=din(),ix+=t+4*e,n}function din(){var t,n=sx.getUint8(ix++);switch(n){case 97:t=[int,1];break;case 98:t=[int,4];break;case 99:t=[flo,0];break;case 70:t=[iee,0];break;case 100:t=[str,2];break;case 104:t=[run,1];break;case 107:t=[arr,2];break;case 108:t=[rut,4];break;case 109:t=[str,4];break;case 110:t=[big,1];break;case 111:t=[big,4];break;case 115:t=[str,1];break;case 118:t=[str,2];break;case 119:t=[str,1];break;case 105:t=[run,4];break;case 116:t=[dic,4];break;case 90:t=[ref,4];break;case 114:t=[ref,1];break;default:t=[nop,0]}return{t:n,v:t[0](t[1])}}function int_to_bytes(t){if(t%1!=0)return[0];var n,e,r,o=[];(n=t<0)&&(t=-t-1),e=t;for(;0!==t;)r=t%256,n&&(r=255-r),o.push(r),t=Math.floor(t/256),0;if(t>0)throw"Argument out of range: "+e;return o}function uc(t,n){if(0==t.byteLength)return n;if(0==n.byteLength)return t;var e=new Uint8Array(t.byteLength+n.byteLength);return e.set(t,0),e.set(n,t.byteLength),e}function ar(t){return t.v instanceof ArrayBuffer?new Uint8Array(t.v):t.v instanceof Uint8Array?t.v:Array.isArray(t.v)?new Uint8Array(t.v):new Uint8Array(utf8_enc(t.v))}function fl(t){return t.reduce(function(t,n){return uc(t,n instanceof Uint8Array?n:Array.isArray(n)?fl(n):new Uint8Array([n]))},new Uint8Array)}function nop(){}function bullet(t){return $conn.url=t,$conn}function xport(){return!(maxReconnects<=ct)&&transports[ct++%transports.length]}function reconnect(){setTimeout(function(){connect()},reconnectDelay)}function next(){return $conn.port=xport(),!!$conn.port&&connect()}function connect(){return $conn.port.channel=$conn.port.creator($conn.url),$conn.port.channel?($conn.port.channel.binaryType="arraybuffer",$conn.port.channel.onmessage=function(t){$conn.onmessage(t)},$conn.port.channel.onopen=function(){$conn.port.heart&&(heartbeat=setInterval(function(){$conn.port.onheartbeat()},$conn.port.interval)),$conn.onopen(),$conn.onconnect()},$conn.port.channel.onclose=function(){$conn.onclose(),clearInterval(heartbeat),reconnect()},$conn):next()}function read_Float(t,n,e,r,o){var a,i,u=8*o-r-1,c=(1<<u)-1,s=c>>1,f=-7,l=e?o-1:0,v=e?-1:1,p=t[n+l];for(l+=v,a=p&(1<<-f)-1,p>>=-f,f+=u;f>0;a=256*a+t[n+l],l+=v,f-=8);for(i=a&(1<<-f)-1,a>>=-f,f+=r;f>0;i=256*i+t[n+l],l+=v,f-=8);if(0===a)a=1-s;else{if(a===c)return i?NaN:1/0*(p?-1:1);i+=Math.pow(2,r),a-=s}return(p?-1:1)*i*Math.pow(2,a-r)}function write_Float(t,n,e,r,o,a){var i,u,c,s=8*a-o-1,f=(1<<s)-1,l=f>>1,v=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:a-1,d=r?1:-1,h=n<0||0===n&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(u=isNaN(n)?1:0,i=f):(i=Math.floor(Math.log(n)/Math.LN2),n*(c=Math.pow(2,-i))<1&&(i--,c*=2),(n+=i+l>=1?v/c:v*Math.pow(2,1-l))*c>=2&&(i++,c/=2),i+l>=f?(u=0,i=f):i+l>=1?(u=(n*c-1)*Math.pow(2,o),i+=l):(u=n*Math.pow(2,l-1)*Math.pow(2,o),i=0));o>=8;t[e+p]=255&u,p+=d,u/=256,o-=8);for(i=i<<o|u,s+=o;s>0;t[e+p]=255&i,p+=d,i/=256,s-=8);t[e+p-d]|=128*h}$ws={heart:!0,interval:5e3,creator:function(t){return!!window.WebSocket&&new window.WebSocket(t)},onheartbeat:function(){this.channel.send("PING")}},$conn={onopen:nop,onmessage:nop,onclose:nop,onconnect:nop,send:function(t){this.port.channel&&this.port.channel.send(t)},close:function(){this.port.channel&&this.port.channel.close()}},ct=0,transports=[$ws],heartbeat=null,reconnectDelay=1e3,maxReconnects=100;var active=!1,debug=!1,session="site-sid",protocol="https:"==window.location.protocol?"wss://":"ws://",querystring=window.location.pathname+window.location.search,host=window.location.hostname;function client(){return""}function token(){return sessionStorage.getItem("token")||tokenC()}function tokenC(){var t=document.cookie.match(new RegExp("(^| )X-Auth-Token=([^;]+)"));return t?t[2]:""}function qi(t){return document.getElementById(t)}function qs(t){return document.querySelector(t)}function qa(t){return document.querySelectorAll(t)}function qn(t){return document.createElement(t)}function is(t,n,e){return null!=t&&(106!=t.t&&(t.v.length===n&&t.v[0].v===e))}function co(t){return match=document.cookie.match(new RegExp(t+"=([^;]+)")),match?match[1]:void 0}function N2O_start(){document.cookie="X-Auth-Token="+token()+"; path=/;"+("localhost"==host?"":" domain=maypower.services;"),ws=new bullet(protocol+host+(""==port?"":":"+port)+"/ws"+querystring),ws.onmessage=function(t){for(var n=0;n<protos.length;n++)if(p=protos[n],"ok"==p.on(t,p.do).status)return},ws.onopen=function(){active||(ws.send("N2O,"+token()),console.log("WS Connect"),active=!0)},ws.onclose=function(){active=!1,console.log("WS Disconnect")},next()}var $io={on:function onio(r,cb){if(!is(r,3,"io"))return{status:""};null==r.v[2].v||null==r.v[2].v[1]||2!=r.v[2].v.length||"Token"!=r.v[2].v[0].v&&"Auth"!=r.v[2].v[0].v||sessionStorage.setItem("token",utf8_arr(r.v[2].v[1].v)),"function"==typeof cb&&cb(r.v[2]);var evalex=utf8_arr(r.v[1].v);debug&&console.log(evalex);try{return eval(evalex),{status:"ok"}}catch(t){return console.log(evalex),console.error("Eval failed:",t),{status:""}}}},$file={on:function(t,n){return is(t,10,"ftpack")?("function"==typeof n&&n(t),{status:"ok"}):{status:""}}},$bert={};$bert.protos=[$io,$file],$bert.on=function(t,n){if(ArrayBuffer.prototype.isPrototypeOf(t.data)&&t.data.byteLength>0){try{var e=dec(t.data);"function"==typeof n&&n(e);for(var r=0;r<$bert.protos.length;r++){var o=$bert.protos[r],a=o.on(e,o.do);if(null!=a&&"ok"==a.status)return a}}catch(t){console.error(t)}return{status:"ok"}}return{status:"error",desc:"data"}};var protos=[$bert];function uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=16*Math.random()|0;return("x"==t?n:3&n|8).toString(16)})}var ftp={queue:[],init:function(t){var n={id:uuid(),status:"init",autostart:ftp.autostart||!1,name:ftp.filename||t.name,sid:ftp.sid||token(),meta:ftp.meta||bin(client()),offset:ftp.offset||0,block:1,total:t.size,file:t};return ftp.queue.push(n),ftp.send(n,"",1),n.id},start:function(t){if(ftp.active)return t&&(ftp.item(t).autostart=!0),!1;var n=t?ftp.item(t):ftp.next();n&&(ftp.active=!0,ftp.send_slice(n))},stop:function(t){var n=ftp.item(t),e=ftp.queue.indexOf(n);ftp.queue.splice(e,1),ftp.active=!1,ftp.start()},send:function(t,n){ws.send(enc(tuple(atom("ftp"),bin(t.id),bin(t.sid),bin(t.name),t.meta,number(t.total),number(t.offset),number(t.block||n.byteLength),bin(n),bin(t.status||"send"))))},send_slice:function(t){this.reader=new FileReader,this.reader.onloadend=function(n){var e=n.target,r=n.target.result;e.readyState===FileReader.DONE&&r.byteLength>=0&&ftp.send(t,r)},this.reader.readAsArrayBuffer(t.file.slice(t.offset,t.offset+t.block))},item:function(t){return ftp.queue.find(function(n){return n&&n.id===t})},next:function(){return ftp.queue.find(function(t){return t&&t.autostart})}};function unbase64(t){for(var n=window.atob(t),e=n.length,r=new Uint8Array(e),o=0;o<e;o++)r[o]=n.charCodeAt(o);return r.buffer}function direct(t){ws.send(enc(tuple(atom("direct"),t)))}function validateSources(){return!0}function querySourceRaw(t){var n,e=document.getElementById(t);if(e)switch(e.tagName){case"FIELDSET":n=(n=qs('[id="'+t+'"]:checked'))?n.value:"";break;case"INPUT":switch(e.getAttribute("type")){case"radio":n=(n=qs("input[name="+t+"]:checked"))?n.value:"";break;case"checkbox":n=(n=qs("input[id="+t+"]:checked"))?n.value:"";break;case"date":n=(n=Date.parse(e.value))&&new Date(n)||"";break;case"calendar":n=pickers[e.id]._d||"";break;case"comboLookup":case"hidden":n=e.hasAttribute("data-bind")?{text:e.value,bind:e.getAttribute("data-bind")}:e.value;break;default:var r=e.contentEditable;n=r&&"true"===r?e.innerHTML:e.value}break;default:if(e.getAttribute("data-vector-input"))n=querySourceRaw(e.children[1].id);else if(e.getAttribute("data-edit-input"))n=querySourceRaw(e.children[0].children[0].children[0].id);else if(e.getAttribute("data-sortable-list"))n=getSortableValues("#"+e.id);else if("true"===e.contentEditable)n=e.innerHTML;else switch(n=e.value){case"true":n=new Boolean(!0);break;case"false":n=new Boolean(!1)}}else n=(n=qs("input[name="+t+"]:checked"))?n.value:"";return n}function querySourceConvert(t){return t&&t.hasOwnProperty("text")&&t.hasOwnProperty("bind")?dec(unbase64(t.bind)):t instanceof Date?tuple(number(t.getFullYear()),number(t.getMonth()+1),number(t.getDate())):t instanceof Boolean?atom(t.valueOf()):t instanceof Array?list.apply(null,t.map(querySourceConvert)):bin(t)}function querySource(t){return querySourceConvert(querySourceRaw(t))}$file.progress=function(t,n){var e=qi("ftp_status");e&&(e.innerHTML=t)},$file.do=function(t){var n=t.v[5].v,e=t.v[6].v,r=t.v[7].v;switch(utf8_arr(t.v[9].v)){case"init":if(1==r)return;(o=ftp.item(utf8_arr(t.v[1].v))||"0").offset=e,o.block=r,o.name=utf8_arr(t.v[3].v),o.status=void 0,o.autostart&&ftp.start(o.id);break;case"send":var o;$file.progress(e,n),(o=ftp.item(utf8_arr(t.v[1].v))).offset=e,o.block=r,r>0&&ftp.active?ftp.send_slice(o):ftp.stop(o.id);break;case"relay":"function"==typeof ftp.relay&&ftp.relay(t)}};
//# sourceMappingURL=n2o.min.js.map
