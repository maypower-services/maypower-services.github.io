function mws_getBreakpoint(e,t=100){return t*Math.ceil(e/t)}function mws_findContainerWidth(e){var t,r;if(e.getAttribute("mws-width"))return e.getAttribute("mws-width");if(e.parentNode.getAttribute("mws-width"))return e.parentNode.getAttribute("mws-width");if(e.getAttribute("data-background-src"))return e.offsetWidth+.2*e.offsetWidth;for(t=0;(e=null!=e?e.parentNode:void 0)instanceof HTMLElement&&!t;)r=window.getComputedStyle(e),/^inline/.test(r.display)||(t=e.offsetWidth);return t}function mws_maxWidth(e,t){var r;return e>(r=t.clientWidth||0)&&(r=e),r<1200?r:1200}function mws_findContainerHeight(e){var t;return e.getAttribute("mws-height")?e.getAttribute("mws-height"):e.parentNode.getAttribute("mws-height")?e.parentNode.getAttribute("mws-height"):(e.getAttribute("mws-ratio")&&(t=e.getAttribute("mws-ratio")),e.parentNode.getAttribute("mws-ratio")&&(t=e.parentNode.getAttribute("mws-ratio")),!!t&&(t=(t=t.split(":"))[0]/t[1],mws_findContainerWidth(e)/t))}function mws_forEachElement(e,t){for(var r=document.querySelectorAll(e),a=0;a<r.length;a++)t(r[a],a)}var mws_getQueryString=function(e,t){var r=t||window.location.href,a=new RegExp("[?&]"+e+"=([^&#]*)","i").exec(r);return a?a[1]:null};function mws_runResponsiveImages(){var e,t,r,a,n;mws_forEachElement("img.cld-responsive, .cld-responsive img, [data-background-src]",function(s){(e=s.getAttribute("data-src")||s.getAttribute("data-background-src")||s.getAttribute("src"))&&0!=(t=mws_findContainerWidth(s))&&(r=mws_findContainerHeight(s),s instanceof HTMLImageElement?mws_getBreakpoint(t):300,a=mws_maxWidth(a=mws_getBreakpoint(t),s),n=mws_getBreakpoint(r),e=crop_image(e,a,n),s.removeAttribute("width"),s instanceof HTMLImageElement?s.setAttribute("src",e):s.style.backgroundImage="url("+e+")")})}function mws_getBackgroundImage(e){return(e.currentStyle||window.getComputedStyle(e,!1)).backgroundImage.slice(4,-1).replace(/"/g,"")}function mws_addClass(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function mws_resetImage(e,t=!1){var r,a=t?mws_getBackgroundImage(e):e.getAttribute("data-src")||e.getAttribute("src");switch(!1){case!/images.unsplash.com(.*)(&w=).*?(&|$)/.test(a):r=a=(a=(a=a.replace(/(&w=).*?(&|$)/,"$13$2")).replace(/(&h=).*?(&|$)/,"$2")).replace(/(&fm=).*?(&|$)/,"$1webp$2");break;case!/images.unsplash.com/.test(a):r=a+="&w=3";break;case!/w_auto:breakpoints/.test(a):r=a=(a=a.replace(/(,|\/)h_([_0-9]*)?/,"")).replace(/w_auto:breakpoints([_0-9]*)(:[0-9]+)?/,"w_auto:breakpoints$1:3");break;case!/\/image\/upload\/v/.test(a):r=a.replace(/\/upload\//,"/upload/w_3/"),a=a.replace(/\/upload\//,"/upload/w_auto/");break;case!(match=/w_(:(\d+))?/.exec(a)):r=(a=(a=(a=(a=a.replace(/(,|\/)h_([_0-9]*)?/,"")).replace(/.jpg$/,".webp")).replace(/.png$/,".webp")).replace(/(,|\/)w_(.*?)(,|\/)/,"$1w_auto$3")).replace(/w_auto/,"w_3")}r&&(t?(e.setAttribute("data-background-src",a),e.style.backgroundImage="url("+r+")"):(mws_addClass(e,"cld-responsive"),e.setAttribute("data-src",a),e.setAttribute("src",r)))}function mws_resetImages(){mws_forEachElement("img",function(e){mws_resetImage(e)});for(var e,t=document.getElementsByTagName("*"),r=0,a=t.length;r<a;r++)(e=t[r]).currentStyle?"none"!==e.currentStyle.backgroundImage&&mws_resetImage(e,!0):window.getComputedStyle&&"none"!==document.defaultView.getComputedStyle(e,null).getPropertyValue("background-image")&&mws_resetImage(e,!0)}function crop_image(e,t,r){switch(t=t||100,r=r||!1,!1){case!/images.unsplash.com/.test(e):var a=e.split("?"),n=a[1]?a[1].split("&"):[];(n=n.filter(function(e){return 0!=e.indexOf("w=")&&(0!=e.indexOf("h=")&&(0!=e.indexOf("fm=")&&0!=e.indexOf("fit=")))})).push("w="+t),r&&n.push("h="+r),n.push("fm=webp"),n.push("fit=crop"),e=a[0]+"?"+n.join("&");break;case!/res.cloudinary.com/.test(e):e=(e=e.replace(/(.*)upload(.*)\/v(.*)/,"$1upload/w_"+t+(r?",h_"+r:"")+",c_thumb/v$3")).substr(0,e.lastIndexOf("."))+".webp"}return e}mws_runResponsiveImages(),window.onresize=mws_runResponsiveImages;
